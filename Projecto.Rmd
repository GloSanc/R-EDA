# White Wine: the quality of the taste by Gloria SANCHEZ

```{r echo=FALSE, message=FALSE, warning=FALSE, packages}
# Notice that the parameter "echo" was set to FALSE for this code chunk. This
# prevents the code from displaying in the knitted HTML output. You should set
# echo=FALSE for all code chunks in your file, unless it makes sense for your
# report to show the code that generated a particular plot.

# The other parameters for "message" and "warning" should also be set to FALSE
# for other code chunks once you have verified that each plot comes out as you
# want it to. This will clean up the flow of your report.

# **Tip**: You will see quoted sections like this throughout the template to
#help you construct your report. Make sure that you remove these notes before
#you finish and submit your project!

# **Tip**: One of the requirements of this project is that your code follows
#good formatting techniques, including limiting your lines to 80 characters or
#less. If you're using RStudio, go into Preferences \> Code \> Display to set up
#a margin line to help you keep track of this guideline!

#PACKAGES
# Load all of the packages that you end up using in your analysis in this code
# chunk.


#install.packages("ggplot2", dependencies = TRUE) 
#install.packages("knitr", dependencies = TRUE)
#install.packages("dplyr", dependencies = TRUE)
#install.packages('gridExtra')
#install.packages("ggcorrplot")
#install_github("ggobi/ggally")
#install.packages("GGally")
#install.packages("ggplot2")
#install.packages("corrgram")
#install.packages('gridExtra')
#install.packages("PerformanceAnalytics")

library(gridExtra)
library(ggthemes)
library(ggplot2)
library(dplyr)
library(ggcorrplot)
library(devtools)
library(corrgram)
library(gridExtra)
library(dplyr)
library(GGally)
library(ggplot2)
#library(scales)
#library(memisc)
library("PerformanceAnalytics")
```


```{r echo=FALSE, message=FALSE, warning=FALSE, Load_the_Data}
# Load the Data
WWQ<-read.csv("wineQualityWhites.csv", sep=',')

#colnames(WWQ_che)
#order=TRUE

```

This report explores a dataset containing 4,898 white wines with 11 variables 
quantifying the chemical properties of each wine. At least 3 wine experts rated
the quality of each wine, providing a rating between 0 (very bad) and 10 
(very excellent).

The aim of this report is to find which chemical properties influence the 
quality of the White wine

# Univariate Plots Section

```{r echo=FALSE, warning=FALSE, Univariate_Plots}

# **Tip**: In this section, you should perform some preliminary exploration of your dataset. Run some summaries of the data and create univariate plots to understand the structure of the individual variables in your dataset. Don't forget to add a comment after each plot or closely-related group of plots! There should be multiple code chunks and text sections; the first one below is just to help you get started.

# **Tip**: Make sure that you leave a blank line between the start / end of each code block and the end / start of your Markdown text so that it is formatted nicely in the knitted text. Note as well that text on consecutive lines is treated as a single space. Make sure you have a blank line between your paragraphs so that they too are formatted for easy readability.


dim (WWQ)

str(WWQ)

summary(WWQ)

```


Our dataset contains 13 variables: 11 chemical properties, the wine rating
(quality) and the wine code (X)

The distribution of the values along the different variables is visible in the
summary table that includes the mean, the median, the min and max value and the
1st and 3rd interquartil.

This dataset seems not to have missing values, as we could see in the summary 
table the min value is higher than 0. Citric acid has a minimum value of 0,
we will check later if it is only one or several wines with value 0 to determine
if that is a missing value or a correct 0 value

```{r echo=FALSE, warning=FALSE, fig.width=9, fig.height=3 }
# Histogram wine rating 
qplot(x = quality,  data = WWQ, binwidth = 1, 
      xlab= 'Wine rating',
      ylab= 'Count',
       color= I('#006600'), fill = I('bisque')) 


table(WWQ$quality,  dnn = "Wine per quality")


```



The quality of the different wine is mainly 5 and 6. To analyze the distribution
of the values we visualize them on some plots with variation on scale, bin width 
and specific focus on some values.

Lets see the acidity properties

```{r echo=FALSE, warning=FALSE, fig.width=9, fig.height=3 }

# Histogram fixed.acidity
qplot(x =  fixed.acidity,  data = WWQ, binwidth = 0.1, 
      xlab= 'Fixed Acidity',
      ylab= 'Count') +
  scale_x_continuous(breaks = seq(0, 14, 0.5))

# Histogram volatile.acidity
qplot(x =  volatile.acidity,  data = WWQ, binwidth = 0.01, 
      xlab= 'Volatile Acidity',
      ylab= 'Count')  +
  scale_x_continuous(breaks = seq(0, 15, 0.05))

# Histogram citric.acid
qplot(x =  citric.acid,  data = WWQ, binwidth = 0.01, 
      xlab= 'Citric Acid',
      ylab= 'Count') +
  scale_x_continuous(breaks = seq(0, 1.7, 0.1))

# Table citric.acid

head((table(WWQ$citric.acid,  dnn = "Count for citric acid low values")))
```

Fixed acidity of most wines moves between 6.3 and 7.3 in a normal distribution. 
There are some wines with very low fixed acidity (left) and some wines with very 
high fixed acidity values (right tail)

Volatile acidity of most wines moves between 0.8 and 1.1 in a normal distribution. 
There are some wines with higher values (right tail)

Citric acidity of most wines moves between 0.27 and 0.39 but there are more around
50 wines with values lower than 0.05 and 19 with value = 0 that we consider
as right data and not missing value


```{r echo=FALSE, warning=FALSE, fig.width=9, fig.height=4 }
# Histogram residual.sugar1
rs1=qplot(x =  residual.sugar,  data = WWQ, binwidth = 0.1, 
      xlab= 'Residual Sugar',
      ylab= 'Count') + 
 scale_x_continuous (breaks = seq(0, 66, 5))

# Histogram residual.sugar1
rs3=qplot(x =  residual.sugar,  data = WWQ, binwidth = 0.1, 
      xlab= 'Residual Sugar',
      ylab= 'Count') + 
 scale_x_log10 (breaks = seq(0, 66, 1))

# Histogram residual.sugar1
rs2=qplot(x =  residual.sugar,  data = WWQ, binwidth = 0.1, 
      xlab= 'Residual Sugar',
      ylab= 'Count') + 
 scale_x_continuous (limits = c(0, 10), breaks = seq(0, 10, 1))


grid.arrange(rs1, rs2,rs3, ncol=3)
```

Residual sugar is mainly between 0 and 10 but there are some values over 10 and
a max value of 65.8. The sugar curve is skewed to the right, if we apply a log10
scale we can see that we have two normal curves

```{r echo=FALSE, warning=FALSE, fig.width=9, fig.height=3}

# Histogram chlorides
qplot(x =  chlorides,  data = WWQ, binwidth = 0.005, 
      xlab= 'Chlorides',
      ylab= 'Count') + 
 scale_x_continuous (breaks = seq(0, 0.35, 0.025))

qplot(x =  chlorides,  data = WWQ, binwidth = 0.001, 
      xlab= 'Chlorides',
      ylab= 'Count') + 
 scale_x_continuous (limits = c(0.025, 0.07), breaks = seq(0, 0.1, 0.005))


# Histogram free.sulfur.dioxide
qplot(x =  free.sulfur.dioxide,  data = WWQ, binwidth = 5, 
      xlab= 'Free Sulfur Dioxide',
      ylab= 'Count') +
  scale_x_continuous (breaks = seq(0, 300, 20))

# Histogram total.sulfur.dioxide
qplot(x =  total.sulfur.dioxide,  data = WWQ, binwidth = 5, 
      xlab= 'Total Sulfur Dioxide',
      ylab= 'Count') + 
 scale_x_continuous (breaks = seq(0, 460, 20))

# Histogram density
d1=qplot(x =  density,  data = WWQ, binwidth = 0.001, 
      xlab= 'Density',
      ylab= 'Count') + 
 scale_x_continuous (limits = c(0.9870, 1.0391),breaks = seq(0.98, 1.040, 0.01))


d2=qplot(x =  density,  data = WWQ, binwidth = 0.00001, 
      xlab= 'Density',
      ylab= 'Count') + 
 scale_x_continuous (limits = c(0.9915, 0.9965),breaks = seq(0.991, 1.0997, 0.001))

grid.arrange(d1, d2, ncol=2)
```

Chlorides, free sulfur and total sulfur have normal distribution with some values
on the right tail

Density values moves from 0.9871 to 1.0340, with a interquartil of ~0.0057.
We fix the limits on the interquartil distance and play with the scale, 
the bin width and breaks to get good visibility of the density distribution that
in detail show that some density are more frequent than others even when the big
picture is a normal distribution


```{r echo=FALSE, warning=FALSE, fig.width=9, fig.height=2}

# Histogram pH
qplot(x =  pH,  data = WWQ, binwidth = 0.01, 
      xlab= 'pH',
      ylab= 'Count') + 
 scale_x_continuous (limits = c(2.5, 4),breaks = seq(2.5, 4, 0.1))

qplot(x =  sulphates,  data = WWQ, binwidth = 0.01, 
      xlab= 'Sulphates',
      ylab= 'Count') + 
 scale_x_continuous (limits = c(0.20, 1.1),breaks = seq(0.2, 1.1, 0.05))





```

pH and Sulphates has normal distribution 
```{r echo=FALSE, warning=FALSE}

qplot(x =  alcohol,  data = WWQ, binwidth = 0.1, 
      xlab= 'Alcohol',
      ylab= 'Count') +
 scale_x_continuous (limits = c(8, 14.5),breaks = seq(8, 14.5, 0.5))

summary (WWQ$alcohol)
```

Alcohol has a normal distribution with a long right tail. 75% of the wines have
less than 11.4% of alcohol. The wine with biggest alcohol have 14.20% 

The boxplot show the values distribution on the different properties 

```{r echo=FALSE, warning=FALSE, fig.width=9, fig.height=6 }
# box plot including outlier

b1=qplot(y= fixed.acidity  , 
       data = WWQ, 
      geom = 'boxplot')+
  theme(axis.ticks.x = element_blank(),
        axis.text.x = element_blank()) 

b2=qplot(y= volatile.acidity , 
       data = WWQ, 
      geom = 'boxplot')+
  theme(axis.ticks.x = element_blank(),
        axis.text.x = element_blank())

b3=qplot(y= citric.acid , 
       data = WWQ, 
      geom = 'boxplot')+
  theme(axis.ticks.x = element_blank(),
        axis.text.x = element_blank()) 

b4=qplot(y= residual.sugar , 
       data = WWQ, 
      geom = 'boxplot')+
  theme(axis.ticks.x = element_blank(),
        axis.text.x = element_blank())

b5=qplot(y= chlorides , 
       data = WWQ, 
      geom = 'boxplot')+
  theme(axis.ticks.x = element_blank(),
        axis.text.x = element_blank()) 

b6=qplot(y= free.sulfur.dioxide , 
       data = WWQ, 
      geom = 'boxplot')+
  theme(axis.ticks.x = element_blank(),
        axis.text.x = element_blank())

b7=qplot(y= total.sulfur.dioxide , 
       data = WWQ, 
      geom = 'boxplot')+
  theme(axis.ticks.x = element_blank(),
        axis.text.x = element_blank())

b8=qplot(y= density , 
       data = WWQ, 
      geom = 'boxplot')+
  theme(axis.ticks.x = element_blank(),
        axis.text.x = element_blank())

b9=qplot(y= pH , 
       data = WWQ, 
      geom = 'boxplot')+
  theme(axis.ticks.x = element_blank(),
        axis.text.x = element_blank()) 

b10=qplot(y= sulphates , 
       data = WWQ, 
      geom = 'boxplot')+
  theme(axis.ticks.x = element_blank(),
        axis.text.x = element_blank()) 


b11=qplot(y= alcohol , 
       data = WWQ, 
      geom = 'boxplot')+
  theme(axis.ticks.x = element_blank(),
        axis.text.x = element_blank())


grid.arrange(b1, b2, b3, b4, b5, b6, b7, b8, b9, b10, b11, ncol=6)



```




Some properties have outliers, it is possible to remove outlier for individually
or after a multivariate analysis.

Removing outlier for some of the properties give a different interpretation of 
the property but it is more interesting if done with multiproperties analysis
It's important to note that we may not always be interested in the bulk of the 
data. Sometimes, the outliers are of interest, and it's important that we 
understand their values and why they appear in the data set.

```{r echo=FALSE, warning=FALSE, fig.width=9, fig.height=6}
# fixed acid
iqr_fa <- IQR(WWQ$fixed.acidity)
Q_fa <- quantile(WWQ$fixed.acidity, probs=c(.25, .75), na.rm = FALSE)
eliminated_fa<- subset(WWQ, WWQ$fixed.acidity > (Q_fa[1] - 1.5*iqr_fa) & WWQ$fixed.acidity < (Q_fa[2]+1.5*iqr_fa))

#sugar
iqr_rs <- IQR(WWQ$residual.sugar)
Q_rs <- quantile(WWQ$residual.sugar, probs=c(.25, .75), na.rm = FALSE)
eliminated_rs<- subset(WWQ, WWQ$residual.sugar > (Q_rs[1] - 1.5*iqr_rs) & WWQ$residual.sugar < (Q_rs[2]+1.5*iqr_rs))


#density
iqr_ds <- IQR(WWQ$density)
Q_ds <- quantile(WWQ$density, probs=c(.25, .75), na.rm = FALSE)
eliminated_ds<- subset(WWQ, WWQ$density > (Q_ds[1] - 1.5*iqr_ds) & WWQ$density < (Q_ds[2]+1.5*iqr_ds))



```



```{r echo=FALSE, warning=FALSE, fig.width=9, fig.height=3 }

# boxplot with and without oulier for some properties

# fixed acid

b1a=ggplot(WWQ) +
  aes(x = "", y = fixed.acidity) +
  geom_boxplot(fill = "#CCFF00") +
  theme_minimal()

b1b=ggplot(eliminated_fa) +
  aes(x = "", y = fixed.acidity) +
  geom_boxplot(fill = "#CCFF00") +
  theme_minimal()

# sugar

b2a=ggplot(WWQ) +
  aes(x = "", y = residual.sugar) +
  geom_boxplot(fill = "#FFCCcc") +
  theme_minimal()

b2b=ggplot(eliminated_rs) +
  aes(x = "", y = residual.sugar) +
  geom_boxplot(fill = "#FFCCcc") +
  theme_minimal()


# density

b3a=ggplot(WWQ) +
  aes(x = "", y = density) +
  geom_boxplot(fill = "#993300") +
  theme_minimal()

b3b=ggplot(eliminated_ds) +
  aes(x = "", y = density) +
  geom_boxplot(fill = "#993300") +
  theme_minimal()

grid.arrange(b1a,b1b,b2a,b2b, b3a,b3b, ncol=6)

```




# Univariate Analysis

The data set contains 4898 observations with 13 variables: 11 chemical properties,
the wine rating (quality) and the wine code (X)

The chimical properties are:- fixed acidity, volatile acidity, citric acid, 
residual sugar, chlorides, free sulfur dioxide, total sulfur dioxide, density, 
pH, sulphates, alcohol.

At least 3 wine experts rated the quality of each wine, providing a rating 
between 0 (very bad) and 10 (very excellent).

The distribution of the values along the different variables is visible in the
summary table that includes the mean, the median, the min and max value and the
1st and 3rd interquartil.

This dataset have no missing values, as we could see in the summary table
the min value is higher than 0, except for citric acid but as the values for 
that moves from 0 to 1.66 and then 0 as min value seems right value and not a 
mistake

The main feature is the quality of the wine that is a result of the chimical 
properties, knowing that is the mix of those chimical properties that generate
a sinegy in the taste of the wine.

The quality of the different wine is mainly 5 and 6. To analyze the distribution
of the values we visualize them on some plots with variation on scale, bin width
and specific focus on some values.

Fixed acidity of most wines moves between 6.3 and 7.3 in a normal distribution. 
There are some wines with very low fixed acidity (left) and some wines with very 
high fixed acidity values (right tail)

Volatile acidity of most wines moves between 0.8 and 1.1 in a normal distribution.
There are some wines with higher values (right tail)

Citric acidity of most wines moves between 0.27 and 0.39 but there are more than
200 wines with values around 0.5 and the even higher values (right tail)

Residual sugar is mainly between 0 and 10 but there are some values over 10 and
a max value of 65.8. We create a plot of values from 0 to 10 to see in detail
the residual sugar distribution.The sugar curve is skewed to the right

Chlorides, free sulfur and total sulfur have normal distribution with some values
on the right tail

Density values moves from 0.9871 to 1.0340, with a interquartil of ~0.0057.
We fix the limits on the interquartil distance and play with the scale, 
the bin width and breaks to get good visibility of the density distribution that
in detail show that some density are more frequent than others even when the big
picture is a normal distribution

pH and Sulphates has normal distribution

Alcohol has a normal distribution with a long right tail. 75% of the wines have 
less than 11.4% of alcohol. The wine with biggest alcohol have 14.20%

The chimical features that are more interesting are the ones with a larger range 
and different values eg. residual sugar, alcohol

Residual sugar is mainly between 0 and 10 but there are some values over 10 and 
a max value of 65.8. We create a plot of values from 0 to 10 to see in detail 
the residual sugar distribution.The sugar curve is skewed to the right

Density values moves from 0.9871 to 1.0340, with a interquartil of ~0.0057. 
We fix the limits on the interquartil distance and play with the scale, the bin
width and breaks to get good visibility of the density distribution that in 
detail show that some density are more frequent than others even when the big 
picture is a normal distribution

Some properties have outliers, it is possible to remove outlier for individually
or after a multivariate analysis.

Removing outlier for some of the properties give a different interpretation of 
the property but it is more interesting if done with multiproperties analysis
It's important to note that we may not always be interested in the bulk of the 
data. Sometimes, the outliers are of interest, and it's important that we 
understand their values and why they appear in the data set


# Bivariate Plots Section

The analysis of two variable start with a plot of correlations among all the
variables

```{r echo=FALSE, message=FALSE, warning=FALSE,  fig.width=9, fig.height=7 }

#**Tip**: Based on what you saw in the univariate plots, what relationships 
#between variables might #be interesting to look at in this section? Don't 
#limit yourself to relationships between a main #output feature and one of the 
#supporting variables. 
#Try to look at relationships between supporting variables as well.

#correlation table
# head(WWQ)
# res <- cor(WWQ)
# round(res, 2)

# Correlation chart

myvars<- names(WWQ) %in% c("X")
WWQ_c <- WWQ[!myvars]

WWQ_corr <- WWQ_c[, c(1,2,3,4,5,6,7,8,9,10,11,12)]


corrgram(WWQ_corr,lower.panel=panel.shade, upper.panel=panel.conf,
            label.pos = c(0.5, 0.2), label.srt=0,
            cex.labels = TRUE, font.labels = 2,
            abs=FALSE,
            col.regions = colorRampPalette(c("red","salmon","white",
                                             "royalblue","navy")),
            cor.method="pearson",
            main="Whithe wine: chemical characteristic correlation" ) 




```

The quality of the wine is positive correlated with the alcohol and negative 
correlated with the density. The residual sugar is positive correlated with the
density and negative correlated with the alcohol.

Distribution of the properties in different levels of quality for the properties 
with hihg correlation (+ or -) 


```{r echo=FALSE, message=FALSE, warning=FALSE,  fig.width=9, fig.height=12 }

#chlorides w/o outliers
iqr_ch <- IQR(WWQ$chlorides)
Q_ch <- quantile(WWQ$chlorides, probs=c(.25, .75), na.rm = FALSE)
eliminated_ch<- subset(WWQ, WWQ$chlorides > (Q_ch[1] - 1.5*iqr_ch) & WWQ$chlorides < (Q_ch[2]+1.5*iqr_ch))

#volatile.acidity w/o outliers
iqr_va <- IQR(WWQ$volatile.acidity)
Q_va <- quantile(WWQ$volatile.acidity, probs=c(.25, .75), na.rm = FALSE)
eliminated_va<- subset(WWQ, WWQ$volatile.acidity > (Q_va[1] - 1.5*iqr_va) & WWQ$volatile.acidity < (Q_va[2]+1.5*iqr_va))

#total sulfur.dioxide w/o outliers
iqr_tsd <- IQR(WWQ$total.sulfur.dioxide)
Q_tsd <- quantile(WWQ$total.sulfur.dioxide, probs=c(.25, .75), na.rm = FALSE)
eliminated_tsd<- subset(WWQ, WWQ$total.sulfur.dioxide > (Q_tsd[1] - 1.5*iqr_tsd) & WWQ$total.sulfur.dioxidey < (Q_tsd[2]+1.5*iqr_tsd))



#nf <- layout( matrix(c(1,2), ncol=2) )

nf <- layout(
  matrix(c(1,1,2,3,4,5), ncol=2, byrow=TRUE), 
  widths=c(1,1,1,1,1), 
  heights=c(1,1,1,1,1))




boxplot(alcohol ~ quality, data=WWQ,
        xlab="Quality", ylab="alcohol")
    
boxplot(density ~ quality, data=eliminated_ds,
        xlab="Quality", ylab="density")

boxplot(total.sulfur.dioxide ~ quality, data=WWQ,
        xlab="Quality", ylab="total.sulfur.dioxide")


boxplot(chlorides ~ quality, data=eliminated_ch,
        xlab="Quality", ylab="Chlorides")

boxplot(volatile.acidity  ~ quality, data=eliminated_va,
        xlab="Quality", ylab="Volatile Acidity")



```


The values related to alcohol are not homogeneous for the different qualities, 
similar happens with density (without outlier) and other properties that has
+ or - correlation with quality.

Lest see that with more details and with the mean and the quantile for each one
with outlier removed for density, chlorides and volatile acidity


```{r echo=FALSE, message=FALSE, warning=FALSE,  fig.width=9, fig.height=12 }




#plot quality/correlated properties

b1 =ggplot (aes(x = quality, y = alcohol), data = WWQ,
      ylim=c(quantile(WWQ$alcohol,0.05),quantile(WWQ$alcohol,0.95)))+
  geom_point(alpha=0.5, 
             position=position_jitter(h=0),
             color='orange2')+
#  coord_trans(y = "sqrt") +
  geom_line(stat='summary', fun=mean)+
  geom_line(stat='summary', fun=quantile, 
            fun.args=list (probs= .1),
            linetype=2, color='magenta2')+
  geom_line(stat='summary', fun=quantile, 
            fun.args=list (probs= .5),
            linetype=2, color='magenta2')+
    geom_line(stat='summary', fun=quantile, 
            fun.args=list (probs= .9),
            linetype=2, color='magenta2')

b2 =ggplot(aes(x = quality, y = density), data = eliminated_ds) +
  geom_point(alpha=0.5, 
             position=position_jitter(h=0),
             color='orange2')+
  coord_trans(y = "sqrt") +
  geom_line(stat='summary', fun=mean)+
  geom_line(stat='summary', fun=quantile, 
            fun.args=list (probs= .1),
            linetype=2, color='magenta2')+
  geom_line(stat='summary', fun=quantile, 
            fun.args=list (probs= .5),
            linetype=2, color='magenta2')+
    geom_line(stat='summary', fun=quantile, 
            fun.args=list (probs= .9),
            linetype=2, color='magenta2')

b3 =ggplot(aes(x = quality, y = total.sulfur.dioxide), data = WWQ) +
  geom_point(alpha=0.5, 
             position=position_jitter(h=0),
             color='orange2')+
  coord_trans(y = "sqrt") +
  geom_line(stat='summary', fun=mean)+
  geom_line(stat='summary', fun=quantile, 
            fun.args=list (probs= .1),
            linetype=2, color='magenta2')+
  geom_line(stat='summary', fun=quantile, 
            fun.args=list (probs= .5),
            linetype=2, color='magenta2')+
    geom_line(stat='summary', fun=quantile, 
            fun.args=list (probs= .9),
            linetype=2, color='magenta2')

b4 =ggplot(aes(x = quality, y = chlorides), data = eliminated_ch) +
  geom_point(alpha=0.5, 
             position=position_jitter(h=0),
             color='orange2')+
  coord_trans(y = "sqrt") +
  geom_line(stat='summary', fun=mean)+
  geom_line(stat='summary', fun=quantile, 
            fun.args=list (probs= .1),
            linetype=2, color='magenta2')+
  geom_line(stat='summary', fun=quantile, 
            fun.args=list (probs= .5),
            linetype=2, color='magenta2')+
    geom_line(stat='summary', fun=quantile, 
            fun.args=list (probs= .9),
            linetype=2, color='magenta2')

b5 =ggplot(aes(x = quality, y =volatile.acidity), data = eliminated_va) +
  geom_point(alpha=0.5, 
             position=position_jitter(h=0),
             color='orange2')+
  coord_trans(y = "sqrt") +
  geom_line(stat='summary', fun=mean)+
  geom_line(stat='summary', fun=quantile, 
            fun.args=list (probs= .1),
            linetype=2, color='magenta2')+
  geom_line(stat='summary', fun=quantile, 
            fun.args=list (probs= .5),
            linetype=2, color='magenta2')+
    geom_line(stat='summary', fun=quantile, 
            fun.args=list (probs= .9),
            linetype=2, color='magenta2')

b6 =ggplot(aes(x = quality, y =fixed.acidity), data = eliminated_fa) +
  geom_point(alpha=1, 
             position=position_jitter(h=0),
             color='orange2')+
  coord_trans(y = "sqrt") +
  geom_line(stat='summary', fun=mean)+
  geom_line(stat='summary', fun=quantile, 
            fun.args=list (probs= .1),
            linetype=2, color='magenta2')+
  geom_line(stat='summary', fun=quantile, 
            fun.args=list (probs= .5),
            linetype=2, color='magenta2')+
    geom_line(stat='summary', fun=quantile, 
            fun.args=list (probs= .9),
            linetype=2, color='magenta2')

grid.arrange(b1, b2, b3, b4, b5, b6,  ncol=2)
```

The alcohol is higher for the better quality and the density is lower for the 
better quality

Lets focus on quality labels 5, 6 and 7 as are the most common


```{r echo=FALSE, message=FALSE, warning=FALSE,  fig.width=9, fig.height=8}

#plot quality/correlated properties

bc1 =ggplot(aes(x = quality, y = alcohol), data = WWQ) +
  xlim(5,7)+
  geom_point(alpha=0.5, 
             position=position_jitter(h=0),
             color='orange2')+
  coord_trans(y = "sqrt") +
  geom_line(stat='summary', fun=mean)+
  geom_line(stat='summary', fun=quantile, 
            fun.args=list (probs= .1),
            linetype=2, color='magenta2')+
  geom_line(stat='summary', fun=quantile, 
            fun.args=list (probs= .5),
            linetype=2, color='magenta2')+
    geom_line(stat='summary', fun=quantile, 
            fun.args=list (probs= .9),
            linetype=2, color='magenta2')

bc2 =ggplot(aes(x = quality, y = density), data = eliminated_ds) +
  xlim(5,7)+
  geom_point(alpha=0.5, 
             position=position_jitter(h=0),
             color='orange2')+
  coord_trans(y = "sqrt") +
  geom_line(stat='summary', fun=mean)+
  geom_line(stat='summary', fun=quantile, 
            fun.args=list (probs= .1),
            linetype=2, color='magenta2')+
  geom_line(stat='summary', fun=quantile, 
            fun.args=list (probs= .5),
            linetype=2, color='magenta2')+
    geom_line(stat='summary', fun=quantile, 
            fun.args=list (probs= .9),
            linetype=2, color='magenta2')

bc3 =ggplot(aes(x = quality, y = total.sulfur.dioxide), data = WWQ) +
  xlim(5,7)+
  geom_point(alpha=0.5, 
             position=position_jitter(h=0),
             color='orange2')+
  coord_trans(y = "sqrt") +
  geom_line(stat='summary', fun=mean)+
  geom_line(stat='summary', fun=quantile, 
            fun.args=list (probs= .1),
            linetype=2, color='magenta2')+
  geom_line(stat='summary', fun=quantile, 
            fun.args=list (probs= .5),
            linetype=2, color='magenta2')+
    geom_line(stat='summary', fun=quantile, 
            fun.args=list (probs= .9),
            linetype=2, color='magenta2')

bc4 =ggplot(aes(x = quality, y = chlorides), data = eliminated_ch) +
  xlim(5,7)+
  geom_point(alpha=0.5, 
             position=position_jitter(h=0),
             color='orange2')+
  coord_trans(y = "sqrt") +
  geom_line(stat='summary', fun=mean)+
  geom_line(stat='summary', fun=quantile, 
            fun.args=list (probs= .1),
            linetype=2, color='magenta2')+
  geom_line(stat='summary', fun=quantile, 
            fun.args=list (probs= .5),
            linetype=2, color='magenta2')+
    geom_line(stat='summary', fun=quantile, 
            fun.args=list (probs= .9),
            linetype=2, color='magenta2')

bc5 =ggplot(aes(x = quality, y = volatile.acidity), data =eliminated_va) +
  xlim(5,7)+
  geom_point(alpha=0.5, 
             position=position_jitter(h=0),
             color='orange2')+
  coord_trans(y = "sqrt") +
  geom_line(stat='summary', fun=mean)+
  geom_line(stat='summary', fun=quantile, 
            fun.args=list (probs= .1),
            linetype=2, color='magenta2')+
  geom_line(stat='summary', fun=quantile, 
            fun.args=list (probs= .5),
            linetype=2, color='magenta2')+
    geom_line(stat='summary', fun=quantile, 
            fun.args=list (probs= .9),
            linetype=2, color='magenta2')

bc6 =ggplot(aes(x = quality, y = fixed.acidity), data = eliminated_fa) +
  xlim(5,7)+
  geom_point(alpha=0.5, 
             position=position_jitter(h=0),
             color='orange2')+
  coord_trans(y = "sqrt") +
  geom_line(stat='summary', fun=mean)+
  geom_line(stat='summary', fun=quantile, 
            fun.args=list (probs= .1),
            linetype=2, color='magenta2')+
  geom_line(stat='summary', fun=quantile, 
            fun.args=list (probs= .5),
            linetype=2, color='magenta2')+
    geom_line(stat='summary', fun=quantile, 
            fun.args=list (probs= .9),
            linetype=2, color='magenta2')

grid.arrange(bc1, bc2, bc3, bc4, bc5, bc6,  ncol=2)
```


Lets see quality relation with alcohol and density in another visualization


```{r echo=FALSE, message=FALSE, warning=FALSE,  fig.width=9, fig.height=4 }
q1=ggplot(aes(x = alcohol, y = quality), data = WWQ )  + 
  geom_jitter(alpha = 0.2, color='red')+
  geom_smooth()+
  geom_smooth(method = 'lm', color='lightslateblue')

q2=ggplot(aes(x = density, y = quality), data = eliminated_ds )  + 
 # geom_jitter(alpha = 1, color='brown')+
  geom_point(fill='Red', color='black', shape=21)+
  geom_smooth()+
  geom_smooth(method = 'lm', color='lightslateblue')

grid.arrange(q1, q2,  ncol=2)


```

It is more clear now with this visualization, then a good wine combine high level
of alcohol and low density

Regarding relation between features we can observe the relation of the density 
with total sulfur.dioxide, residual sugar, fixed acidity and chlorides


```{r echo=FALSE, message=FALSE, warning=FALSE, fig.width=9, fig.height=9}
# Density w/o outliers : total.sulfur.dioxide, residual sugar, fixed acidity and chlorides
#plot eliminated_ds/correlated properties

ds1 =ggplot (aes(x = density, y = total.sulfur.dioxide), data = eliminated_ds)+
  geom_point( color='tan1')+
  ylim(0,300)+
    geom_smooth()+
  geom_smooth(method = 'lm', color='magenta4')

ds2 =ggplot(aes(x = density, y = residual.sugar), data = eliminated_ds) +
  geom_point(color='tan1')+
    geom_smooth()+
  geom_smooth(method = 'lm', color='magenta4')

ds3 =ggplot(aes(x = density, y = fixed.acidity), data = eliminated_ds) +
  geom_point(color='tan1')+
  ylim(4.5,9)+
    geom_smooth()+
  geom_smooth(method = 'lm', color='magenta4')

ds4 =ggplot(aes(x = density, y = chlorides), data = eliminated_ds) +
  geom_point(color='tan1')+
  ylim(0,0.0750)+
  geom_smooth()+
  geom_smooth(method = 'lm', color='magenta4')





grid.arrange(ds1, ds2, ds3, ds4,  ncol=2)
```

Lower density, better quality. Low total sulfites, low fixed acidity, low 
chlorides and low residual sugar linked to a lower density, ergo, a better win

The stronger relations are between density and alcohol (negative correlation 
of 78%) and density and residual sugar (positive correlation of 84)

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.width=9, fig.height=10 }

# biggest correlations

bc1=ggplot(aes(x = alcohol, y = density), data = WWQ )  + 
  geom_jitter(alpha = 0.2, color='mediumorchid')+
  ylim(0.987, 1.001)+
  geom_smooth()

bc2=ggplot(aes(x = alcohol, y = residual.sugar), data = WWQ )  + 
  geom_jitter(alpha = 0.2, color='mediumorchid')+
  ylim(0, 20)+
  geom_smooth()

bc3=ggplot(aes(x = alcohol, y = total.sulfur.dioxide), data = WWQ )  + 
  geom_jitter(alpha = 0.2, color='mediumorchid')+
  ylim(0,300)+
  geom_smooth()

bc4=ggplot(aes(x = alcohol, y = chlorides), data = WWQ )  + 
  geom_jitter(alpha = 0.2, color='mediumorchid')+
  ylim(0,0.0750)+
  geom_smooth()

grid.arrange(bc1, bc2, bc3, bc4,  ncol=2)
```

# Bivariate Analysis

The quality of the wine is positive correlated with the alcohol and negative 
correlated with the density. The residual sugar is positive correlated with the
density and negative correlated with the alcohol.

Lower density means better quality. Low total sulfur dioxide, low fixed 
acidity, low chlorides and low residual sugar linked to a lower density, ergo, 
a better wine. This point is to be investigated in the multivariate analysis

The stronger relations are between density and alcohol (negative correlation 
of 78%) and density and residual sugar (positive correlation of 84%)

Density has strong positive correlation with residual sugar and total sulfur and
moderate with chlorides and fixed acidity

Alcohol has strong negative correlation with density and moderate negative 
correlation with total sulfur, residual sugar and chlorides

Residual sugar has moderate positive correlation with total sulfur and negative 
with alcohol and strong positive correlation with density

Chlorides has as moderate positive correlation with density and negative 
with alcohol

The fixed acidity, the volatile acidity and the citric acid have low correlation 
with the other variable, except for pH. 

Free sulfur has low correlation with other variables except for total sulfur 

Total sulfur has moderate positive with density and negative with alcohol

pH has no correlation except negative with fixed acidity

Sulfates has no correlation with any variable

It will be interesting to investigate the data with multivariate plots

# Multivariate Plots Section

The analysis multivariate of white wine is going to be done to analyze the 
distribution of the wine per quality in relation of 
 - alcohol and density,
 - density and residual sugar,
 - alcohol and chlorides,
 - alcohol and total sulfur dioxides,
 

```{r echo=FALSE, message=FALSE, warning=FALSE,  fig.width=9, fig.height=16 }


quality.cut <- cut(WWQ$quality, breaks = c(2,3,4,5,6,7,8,9,10))

mv1=ggplot(WWQ, aes(x = alcohol, y = density , color = quality.cut)) +
  coord_cartesian(
      xlim = c(quantile(WWQ$alcohol, .01), quantile(WWQ$alcohol, .99)),
      ylim = c(quantile(WWQ$density, .01), quantile(WWQ$density, .99))) +
  geom_jitter(alpha =15, size = 1.5) +
  geom_smooth(method = "lm", se = FALSE) +
  scale_color_brewer(type = "div", palette = "RdYlBu",
                     name = "Quality", direction = -1) +
  theme_dark() +
  theme(legend.position = c(0.9, 0.7))+
  theme(legend.background = element_rect(fill="lightblue",
                                  size=0.5, linetype="solid", 
                                  colour ="darkblue"))+
  ggtitle("Alcohol vs Denstiy") +
  xlab("Alcohol") +
  ylab("Density")


quality_max.cut <- cut(WWQ$quality, breaks = c(5,6,7,8))

mv2=ggplot(WWQ, aes(x = alcohol, y = density , #color = quality_max.cut
                )) +
  coord_cartesian(
      xlim = c(quantile(WWQ$alcohol, .01), quantile(WWQ$alcohol, .99)),
      ylim = c(quantile(WWQ$density, .01), quantile(WWQ$density, .99))
      ) +
  geom_jitter(alpha = 10, size = 1.5) +
  geom_point(aes(colour = factor(quality_max.cut)), size = 4)+
  geom_point(colour = "black", size = 3) +
  geom_point(colour = "pink", size = 4) +
  geom_point(aes(shape = factor(quality_max.cut)))+
  geom_smooth(method = "lm", se = FALSE) +
  theme(legend.position = c(0.9, 0.7))+
  theme(legend.background = element_rect(fill="grey",
                                  size=0.5, linetype="solid", 
                                  colour ="darkblue"))+
  ggtitle("Alcohol vs Denstiy") +
  xlab("Alcohol") +
  ylab("Density")


mv3=qplot(x = alcohol, y = density, data = WWQ, color = quality) + coord_cartesian(ylim = c(0.985, 
    1.005))+   geom_smooth(method = "lm", se = FALSE) +ggtitle('Alcohol vs Denstiy')

grid.arrange(mv1, mv2, mv3, ncol=1)

```

Those 3 chart represent the same information but none of them are really clear, 
they are good examples of what important the colors, shape and size of the chart
elements are basic


```{r echo=FALSE, message=FALSE, warning=FALSE,  fig.width=9, fig.height=6 }
qplot(x = alcohol, y = density, data = WWQ, color = quality, alpha = I(1/5)) + 
    coord_cartesian(ylim = c(0.985, 1.005)) + facet_wrap(~quality)+
    scale_color_gradientn(colours = rainbow(9))+ 
    geom_smooth(method = "lm", se = FALSE) +
    ggtitle('Alcohol and density per quality')
```

It is clear that there is a movement from left to right and up down along the 
quality of the wines, it means that better wines have less density and more
alcohol but the line between a wine quality 5, 6 and 7 is not crystal
clear

```{r echo=FALSE, message=FALSE, warning=FALSE,  fig.width=9, fig.height=10 }


quality.cut <- cut(WWQ$quality, breaks = c(2,3,4,5,6,7,8,9,10))

mv1=ggplot(WWQ, aes(x = residual.sugar, y = density , color = quality.cut)) +
  coord_cartesian(
      xlim = c(quantile(WWQ$residual.sugar, .01), quantile(WWQ$residual.sugar, .99)),
      ylim = c(quantile(WWQ$density, .01), quantile(WWQ$density, .99))
      ) +
  geom_jitter(alpha =3, size = 1.5) +
  geom_smooth(method = "lm", se = FALSE) +
  scale_color_brewer(palette = "PuOr") +
  theme_dark() +
  ggtitle("Residual Sugar vs Denstiy") +
  xlab("residual.sugar") +
  ylab("Density")


quality_max.cut <- cut(WWQ$quality, breaks = c(5,6,7,8))


mv3=qplot(x = residual.sugar, y = density, data = WWQ, color = quality) + coord_cartesian(xlim=c(0,20),ylim = c(0.987, 
    1.001))+
  geom_smooth(method = "lm", se = FALSE) +
  ggtitle('Residual Sugar vs Denstiy')

grid.arrange(mv1,  mv3, ncol=2)

```

It is not so good visually but it is clear that low residual sugar and low 
density are good indications of a good wine 

```{r echo=FALSE, message=FALSE, warning=FALSE,  fig.width=9, fig.height=6}
qplot(x = residual.sugar, y = density, data = WWQ, color = quality, alpha = I(1/5)) + 
    coord_cartesian(xlim=c(0,20),ylim = c(0.987, 1.001)) + 
    facet_wrap(~quality)+
    scale_color_gradientn(colours = rainbow(9)) + 
    geom_smooth(method = "lm", se = FALSE) +
    ggtitle('Residual Sugar and Denstiy per quality')
```

It is clear that there is a movement from right to left and top to down along the 
quality of the wines, it means that better wines have less density and less
sugar but the line between a wine quality 5, 6 and 7 is not crystal
clear

```{r echo=FALSE, message=FALSE, warning=FALSE,  fig.width=9, fig.height=6 }
qplot(x = alcohol, y = chlorides, data = WWQ, color = quality, alpha = I(1/5)) +
    ylim(0,0.0750)+
    facet_wrap(~quality)+
    scale_color_gradientn(colours = rainbow(5))+ 
    geom_smooth(method = "lm", se = FALSE) +
    ggtitle('Alcohol and chlorides per quality')
```


```{r echo=FALSE, message=FALSE, warning=FALSE,  fig.width=9, fig.height=6 }

mts1=ggplot(WWQ, aes(x = alcohol, y = total.sulfur.dioxide , color = quality.cut)) +
  coord_cartesian(
      xlim = c(quantile(WWQ$alcohol, .01), quantile(WWQ$alcohol, .99)),
      ylim = c(quantile(WWQ$total.sulfur.dioxide, .01), quantile(WWQ$total.sulfur.dioxide, .99))) +
  geom_jitter(alpha =15, size = 1.5) +
  geom_smooth(method = "lm", se = FALSE) +
  scale_color_brewer(type = "div", palette = "RdYlBu",
                     name = "Quality", direction = -1) +
  theme_dark() +
  theme(legend.position = c(0.9, 0.7))+
  theme(legend.background = element_rect(fill="lightblue",
                                  size=0.5, linetype="solid", 
                                  colour ="darkblue"))+
  ggtitle("Alcohol vs total.sulfur.dioxide") +
  xlab("Alcohol") +
  ylab("total.sulfur.dioxide")


mts2=qplot(x = alcohol, y = total.sulfur.dioxide, data = WWQ, color = quality) +
   coord_cartesian(
      xlim = c(quantile(WWQ$alcohol, .01), quantile(WWQ$alcohol, .99)),
      ylim = c(quantile(WWQ$total.sulfur.dioxide, .01), quantile(WWQ$total.sulfur.dioxide, .99))) +
  geom_smooth(method = "lm", se = FALSE) +
  ggtitle('Alcohol vs total.sulfur.dioxide"')

grid.arrange(mts1,  mts2, ncol=2)


```



```{r echo=FALSE, message=FALSE, warning=FALSE,  fig.width=9, fig.height=6 }
qplot(x = alcohol, y = total.sulfur.dioxide, data = WWQ, color = quality, alpha = I(1/5)) + 
    facet_wrap(~quality)+
    coord_cartesian(ylim = c(0, 300)) + 
    scale_color_gradientn(colours = rainbow(5))+ 
    geom_smooth(method = "lm", se = FALSE) +
    ggtitle('Alcohol and Total sulfur dioxides per quality')
```



```{r echo=FALSE, message=FALSE, warning=FALSE,  fig.width=9, fig.height=6}
qplot(x = alcohol, y = residual.sugar, data = WWQ, color = quality, alpha = I(1/5)) + 
    facet_wrap(~quality)+
    coord_cartesian(ylim = c(0, 20)) + 
    scale_color_gradientn(colours = rainbow(5))+ 
    geom_smooth(method = "lm", se = FALSE) +
    ggtitle('Alcohol and Residual sugar per quality')
```
```{r echo=FALSE, message=FALSE, warning=FALSE,  fig.width=9, fig.height=6}
qplot(x = residual.sugar, y = chlorides, data = WWQ, color = quality, alpha = I(1/5)) +
    xlim(0, 20) + ylim(0,0.0750)+
    facet_wrap(~quality)+
    scale_color_gradientn(colours = rainbow(5))+ 
    geom_smooth(method = "lm", se = FALSE) +
    ggtitle('Residual sugar and chlorides per quality')
```


```{r echo=FALSE, message=FALSE, warning=FALSE,  fig.width=9, fig.height=6 }

mts1=ggplot(WWQ, aes(x = chlorides, y = total.sulfur.dioxide , color = quality.cut)) +
  coord_cartesian(
      xlim = c(quantile(WWQ$chlorides, .01), quantile(WWQ$chlorides, .99)),
      ylim = c(quantile(WWQ$total.sulfur.dioxide, .01), quantile(WWQ$total.sulfur.dioxide, .99))) +
  geom_jitter(alpha =15, size = 1.5) +
  geom_smooth(method = "lm", se = FALSE) +
  scale_color_brewer(type = "div", palette = "RdYlBu",
                     name = "Quality", direction = -1) +
  theme_dark() +
  theme(legend.position = c(0.9, 0.7))+
  theme(legend.background = element_rect(fill="lightblue",
                                  size=0.5, linetype="solid", 
                                  colour ="darkblue"))+
  ggtitle("Chlorides vs total.sulfur.dioxide") +
  xlab("Chlorides") +
  ylab("total.sulfur.dioxide")


mts2=qplot(x = chlorides, y = total.sulfur.dioxide, data = WWQ, color = quality) +
   coord_cartesian(
      xlim = c(quantile(WWQ$chlorides, .01), quantile(WWQ$chlorides, .99)),
      ylim = c(quantile(WWQ$total.sulfur.dioxide, .01), quantile(WWQ$total.sulfur.dioxide, .99))) +
  geom_smooth(method = "lm", se = FALSE) +
  ggtitle('Chlorides vs total.sulfur.dioxide"')

grid.arrange(mts1,  mts2, ncol=2)

```

```{r echo=FALSE, message=FALSE, warning=FALSE,  fig.width=9, fig.height=6}
qplot(x = chlorides, y = total.sulfur.dioxide, data = WWQ, color = quality, alpha = I(1/20)) + 
    facet_wrap(~quality)+
    coord_cartesian(
      xlim = c(quantile(WWQ$chlorides, .05), quantile(WWQ$chlorides, .95)),
      ylim = c(quantile(WWQ$total.sulfur.dioxide, .05), quantile(WWQ$total.sulfur.dioxide, .95))) + 
    scale_color_gradientn(colours = terrain.colors(7))+ 
    geom_smooth(method = "lm", se = FALSE) +
    ggtitle('Chlorides and Total sulfur dioxides per quality')

```


```{r echo=FALSE, message=FALSE, warning=FALSE,  fig.width=9, fig.height=6 }

# dataset reduction to interquantile
iqr_cl <- IQR(WWQ$chlorides)
Q_cl <- quantile(WWQ$chlorides, probs=c(.25, .75), na.rm = FALSE)

iqr_ts <- IQR(WWQ$total.sulfur.dioxide)
Q_ts <- quantile(WWQ$total.sulfur.dioxide, probs=c(.25, .75), na.rm = FALSE)



eliminated_cl_ts<- subset(WWQ, WWQ$chlorides > (Q_cl[1] - 1.5*iqr_cl) & WWQ$chlorides < (Q_cl[2]+1.5*iqr_cl)&
                WWQ$total.sulfur.dioxide < (Q_ts[2]+1.5*iqr_ts)& WWQ$total.sulfur.dioxide < (Q_ts[2]+1.5*iqr_ts))




```





```{r echo=FALSE, message=FALSE, warning=FALSE,  fig.width=9, fig.height=6 }

quality.cut2 <- cut(eliminated_cl_ts$quality, breaks = c(2,3,4,5,6,7,8,9,10))


mts1=ggplot(eliminated_cl_ts, aes(x = chlorides, y = total.sulfur.dioxide , color = quality.cut2)) +
  
  geom_jitter(alpha =1, size = 0.5) +
  geom_smooth(method = "lm", se = FALSE) +
  scale_color_brewer(type = "div", palette = "RdYlBu",
                     name = "Quality", direction = -1) +
  theme_dark() +
 # theme(legend.position = c(0.9, 0.7))+
  theme(legend.background = element_rect(fill="lightblue",
                                  size=0.5, linetype="solid", 
                                  colour ="darkblue"))+
  ggtitle("Chlorides vs total.sulfur.dioxide") +
  xlab("Chlorides") +
  ylab("total.sulfur.dioxide")


mts2=qplot(x = chlorides, y = total.sulfur.dioxide, data = eliminated_cl_ts, color = quality) +
  geom_smooth(method = "lm", se = FALSE) +
  ggtitle('Chlorides vs total.sulfur.dioxide"')

grid.arrange(mts1,  mts2, ncol=2)
```


```{r echo=FALSE, message=FALSE, warning=FALSE,  fig.width=9, fig.height=6}
qplot(x = chlorides, y = total.sulfur.dioxide, data = eliminated_cl_ts, color = quality, alpha = I(1/20)) + 
    facet_wrap(~quality)+
    scale_color_gradientn(colours = terrain.colors(7))+ 
    geom_smooth(method = "lm", se = FALSE) +
    ggtitle('Chlorides and Total sulfur dioxides per quality')
```

```{r echo=FALSE, message=FALSE, warning=FALSE,  fig.width=9, fig.height=6}
qplot(x = chlorides, y = total.sulfur.dioxide, data = WWQ, color = quality, alpha = I(1/20)) + 
    facet_wrap(~quality)+
    coord_cartesian(
      xlim = c(quantile(WWQ$chlorides, .05), quantile(WWQ$chlorides, .95)),
      ylim = c(quantile(WWQ$total.sulfur.dioxide, .05), quantile(WWQ$total.sulfur.dioxide, .95))) + 
    scale_color_gradientn(colours = terrain.colors(7))+ 
    geom_smooth(method = "lm", se = FALSE) +
    ggtitle('Chlorides and Total sulfur dioxides per quality')
```



# Multivariate Analysis

Lower density means better quality. Low total sulfur dioxide, low fixed 
acidity, low chlorides and low residual sugar linked to a lower density, ergo, 
a better wine. 
That is like that for all white wines.
The analysis of the different white wines characteristic per quality does not 
give clear differences between them.
Alcohol and residual sugar seams to interact and more we move from a bad wine to 
a better wine the figure moves to the less sugar and more alcohol 

------------------------------------------------------------------------

# Final Plots and Summary

### Plot One

```{r echo=FALSE, message=FALSE, warning=FALSE,  fig.width=9, fig.height=5, Plot_One}
# Histogram wine rating 
qplot(x = quality,  data = WWQ, binwidth = 1, 
      xlab= 'Wine rating',
      ylab= 'Count',
      color= I('#006600'), fill = I('lightgoldenrod1'))+
      geom_text(x = 4, y = 1900, label = "~3600 white wine are good wines",
              color="black")

```

### Description One
This plot is the basic one that gives the information about what is the basic 
structure of the data, in a simple view we see that the distribution of the wine
quality is a normal curve.

Next step is try to find what are the characteristic that makes a wine be in a
category 5 or 6, what are the combinations of characteristic that could allow
to define if a wine is 5 or 9.


### Plot Two

```{r echo=FALSE, message=FALSE, warning=FALSE,  fig.width=9, fig.height=5, Plot_Two}

quality.cut <- cut(WWQ$quality, breaks = c(2,3,4,5,6,7,8,9,10))

ggplot(WWQ, aes(x = alcohol, y = density , color = quality.cut, size=residual.sugar)) +
  coord_cartesian(
      xlim = c(quantile(WWQ$alcohol, .25), quantile(WWQ$alcohol, .75)),
      ylim = c(quantile(WWQ$density, .25), quantile(WWQ$density, .75))) +
  geom_jitter(alpha =15, size = 1.5) +
  geom_smooth(method = "lm", se = FALSE) +
  scale_color_brewer(type = "div", palette = "RdYlBu",
                     name = "Quality", direction = -1) +
  theme_dark() +
  theme(legend.position = c(0.9, 0.8))+
  theme(legend.background = element_rect(fill="lightblue",
                                  size=0.5, linetype="solid", 
                                  colour ="darkblue"))+
  ggtitle("Alcohol vs Denstiy") +
  xlab("Alcohol") +
  ylab("Density")

```

### Description Two
The two chemical characteristic that have more correlation with the quality of
the wine are the alcohol (+44%) and the density (-31%). Those correlation levels
are not strong

If we analyze the distribution of those characteristic in the different quality 
categories we do not found big differences, the lines representing the linear 
regression for each category are very close and nearly parallel

We can see points of quality 5 and 6 all along and those are the most frequent
wines

### Plot Three

```{r echo=FALSE, message=FALSE, warning=FALSE,  fig.width=9, fig.height=5, Plot_Three}

p31=ggplot(WWQ, aes(x = chlorides, y = total.sulfur.dioxide , color = quality.cut)) +
  geom_jitter(alpha =15, size = 1.5) +
  geom_smooth(method = "lm", se = FALSE) +
  scale_color_brewer(type = "div", palette = "RdYlBu",
                     name = "Quality", direction = -1) +
  theme_dark() +
  theme(legend.position = c(0.9, 0.7))+
  theme(legend.background = element_rect(fill="lightblue",
                                  size=0.5, linetype="solid", 
                                  colour ="darkblue"))+
  ggtitle("Chlorides vs total.sulfur.dioxide") +
  xlab("Chlorides") +
  ylab("total.sulfur.dioxide")

p32=ggplot(eliminated_cl_ts, aes(x = chlorides, y = total.sulfur.dioxide , color = quality.cut2)) +
  
  geom_jitter(alpha =1, size = 0.5) +
  geom_smooth(method = "lm", se = FALSE) +
  scale_color_brewer(type = "div", palette = "RdYlBu",
                     name = "Quality", direction = -1) +
  theme_dark() +
 # theme(legend.position = c(0.9, 0.7))+
  theme(legend.background = element_rect(fill="lightblue",
                                  size=0.5, linetype="solid", 
                                  colour ="darkblue"))+
  ggtitle("Chlorides vs total.sulfur.dioxide interquantile") +
  xlab("Chlorides") +
  ylab("total.sulfur.dioxide")

grid.arrange(p31,  p32, ncol=2)
```

### Description Three

These two chart are showing the the relation between quality, chlorides and 
total sulfur dioxide.
The only difference is that the first show the whole perimetre of the dataset,
including outliers and the second one show the data interquantile (25%-75%)
It is important when analysing data to take into acount what is the impact of
the outliers in the result. 
The first chart could induce to think that there are really big differences on
wine quality related to those two characteristic, in the second chart we can see
that does differences are not so big.



------------------------------------------------------------------------

# Reflection

The analysis of the 4898 white wines show that there are not much bad wine (183).
Nearly the half of the wines are considered as 6 and a ~1500 as 5, both values 
are for good wines.
There are less than 1000 wine that are valuate at 7 and only 5 as 9.

It is difficult to find a pattern or a characteristic that makes the difference
between the wines, what could induce to think that there are other characteristic
that makes the difference but are not considered in the dataset.
The color, the flavor and the smell of a wine depends not only in the quantity
of alcohol and sugar but which is the process of maturity of the wine, the year
of collection of the wrapes and other linked with the date of taste and the 
expert situation. 

The fact that there were 3 expert that taste the wine prevent a possible bias

The conclusion after analyzing the data is that if we go to a shop and buy a 
white wine we have more than 80% probability to buy a good wine. 
Unless you are a bad lucky person.

Personal reflection: a good white wine and a great white wine could have same 
chemical properties because what makes a whine great is the spirit inside.
Personally I prefer the sweet wines with low level of alcohol, then probably I 
like more a wine 6 than a wine 7 or 8  




# List of web
http://zevross.com/blog/2017/06/19/tips-and-tricks-for-working-with-images-and-figures-in-r-markdown-documents/

https://www.tidyverse.org/packages/

http://www.sthda.com/english/wiki/colors-in-r

https://humansofdata.atlan.com/2018/03/when-delete-outliers-dataset/

https://statsandr.com/blog/outliers-detection-in-r/

https://stats.idre.ucla.edu/r/faq/how-can-i-explore-different-smooths-in-ggplot2/

https://rpubs.com/profversaggi/lesson_four_problem_set

https://blog.rstudio.com/2014/01/17/introducing-dplyr/

https://rpubs.com/profversaggi/exploring_multivariate_data

https://www.r-graph-gallery.com/75-split-screen-with-layout.html

http://www.stat.columbia.edu/~tzheng/files/Rcolor.pdf?utm_source=twitterfeed&utm_medium=twitter

https://ggplot2.tidyverse.org/reference/scale_brewer.html

https://www.statmethods.net/advgraphs/axes.html

https://github.com/wengsengh/Exploratory_Data_Analysis/blob/master/wineQualityWhites.rmd

http://www.sthda.com/english/wiki/ggplot2-colors-how-to-change-colors-automatically-and-manually

https://olegleyz.github.io/exploratory-data-analysis-of-the-white-wine-based-on-physicochemical-properties.html

http://mml.citi.sinica.edu.tw/cahou/RReport.html

https://rpubs.com/prasad_pagade/wine_quality_prediction

http://www.sthda.com/english/wiki/be-awesome-in-ggplot2-a-practical-guide-to-be-highly-effective-r-software-and-data-visualization

https://ggplot2.tidyverse.org/reference/scale_gradient.html

https://medium.com/@wengsengh/wine-quality-exploration-with-r-dca52264dca8

https://online.stat.psu.edu/stat508/book/export/html/804

https://en.wikipedia.org/wiki/Wine_chemistry



